<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ©Ÿè»Šè¡Œç¶­ä¿®ç®¡ç†ç³»çµ± (PoC)</title>
  <script src="https://unpkg.com/vue@3"></script>
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
  <script src="https://unpkg.com/element-plus"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: "Noto Sans TC", sans-serif; background: #f5f7fa; margin: 0; }
    .container { max-width: 1000px; margin: 30px auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <div id="app" class="container">
    <el-menu mode="horizontal" :default-active="activePage" @select="activePage = $event" style="margin-bottom: 20px;">
      <el-menu-item index="jobs">ğŸ§¾ ç¶­ä¿®å–®</el-menu-item>
      <el-menu-item index="customers">ğŸ‘¤ å®¢æˆ¶</el-menu-item>
      <el-menu-item index="parts">ğŸ§° é›¶ä»¶åº«å­˜</el-menu-item>
      <el-menu-item index="reports">ğŸ’° æ”¶æ”¯å ±è¡¨</el-menu-item>
      <el-menu-item index="staff">ğŸ‘¨â€ğŸ”§ æŠ€å¸«ç®¡ç†</el-menu-item>
    </el-menu>

    <!-- ç¶­ä¿®å–®ç®¡ç† -->
    <div v-if="activePage === 'jobs'">
      <h2>ç¶­ä¿®å–®ç®¡ç†</h2>
      <el-form :model="newJob" inline style="margin-top: 10px;">
        <el-form-item label="å®¢æˆ¶"><el-input v-model="newJob.customer" placeholder="å§“å"></el-input></el-form-item>
        <el-form-item label="è»Šç‰Œ"><el-input v-model="newJob.plate" placeholder="ABC-1234"></el-input></el-form-item>
        <el-form-item label="é …ç›®"><el-input v-model="newJob.item" placeholder="æ›æ©Ÿæ²¹"></el-input></el-form-item>
        <el-form-item label="é‡‘é¡"><el-input v-model.number="newJob.price" type="number"></el-input></el-form-item>
        <el-form-item><el-button type="primary" @click="addJob">æ–°å¢</el-button></el-form-item>
      </el-form>

      <el-table :data="jobs" style="width:100%;margin-top:10px;" border>
        <el-table-column prop="id" label="å–®è™Ÿ" width="60"></el-table-column>
        <el-table-column prop="customer" label="å®¢æˆ¶"></el-table-column>
        <el-table-column prop="plate" label="è»Šç‰Œ"></el-table-column>
        <el-table-column prop="item" label="é …ç›®"></el-table-column>
        <el-table-column prop="price" label="é‡‘é¡"></el-table-column>
        <el-table-column label="ç‹€æ…‹">
          <template #default="scope">
            <el-select v-model="scope.row.status" @change="saveJobs">
              <el-option label="å¾…ç¶­ä¿®" value="å¾…ç¶­ä¿®"></el-option>
              <el-option label="ç¶­ä¿®ä¸­" value="ç¶­ä¿®ä¸­"></el-option>
              <el-option label="å·²å®Œæˆ" value="å·²å®Œæˆ"></el-option>
            </el-select>
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="100">
          <template #default="scope">
            <el-button size="small" type="danger" @click="deleteJob(scope.row.id)">åˆªé™¤</el-button>
          </template>
        </el-table-column>
      </el-table>
    </div>

    <!-- å®¢æˆ¶ç®¡ç† -->
    <div v-if="activePage === 'customers'">
      <h2>å®¢æˆ¶è³‡æ–™</h2>
      <el-input v-model="searchCustomer" placeholder="æœå°‹å§“åæˆ–è»Šç‰Œ..." style="margin-bottom:10px;width:300px;"></el-input>
      <el-table :data="filteredCustomers" border>
        <el-table-column prop="name" label="å§“å"></el-table-column>
        <el-table-column prop="phone" label="é›»è©±"></el-table-column>
        <el-table-column prop="plate" label="è»Šç‰Œ"></el-table-column>
        <el-table-column prop="lastService" label="ä¸Šæ¬¡ç¶­ä¿®"></el-table-column>
      </el-table>
    </div>

    <!-- é›¶ä»¶åº«å­˜ -->
    <div v-if="activePage === 'parts'">
      <h2>é›¶ä»¶åº«å­˜</h2>
      <el-table :data="parts" border>
        <el-table-column prop="name" label="é›¶ä»¶åç¨±"></el-table-column>
        <el-table-column prop="stock" label="åº«å­˜">
          <template #default="scope">
            <el-input-number v-model="scope.row.stock" @change="saveParts" :min="0"></el-input-number>
          </template>
        </el-table-column>
        <el-table-column prop="min" label="è­¦ç¤ºå€¼"></el-table-column>
        <el-table-column label="ç‹€æ…‹">
          <template #default="scope">
            <el-tag :type="scope.row.stock <= scope.row.min ? 'danger' : 'success'">
              {{ scope.row.stock <= scope.row.min ? 'éœ€è£œè²¨' : 'æ­£å¸¸' }}
            </el-tag>
          </template>
        </el-table-column>
      </el-table>
    </div>

    <!-- æ”¶æ”¯å ±è¡¨ -->
    <div v-if="activePage === 'reports'">
      <h2>æ”¶æ”¯å ±è¡¨</h2>
      <el-row :gutter="20">
        <el-col :span="8"><el-statistic title="æœ¬æœˆç‡Ÿæ”¶" :value="32000" suffix="NTD"></el-statistic></el-col>
        <el-col :span="8"><el-statistic title="æœ¬æœˆæˆæœ¬" :value="12000" suffix="NTD"></el-statistic></el-col>
        <el-col :span="8"><el-statistic title="æœ¬æœˆæ·¨åˆ©" :value="20000" suffix="NTD"></el-statistic></el-col>
      </el-row>
      <canvas id="chart" style="margin-top:20px;max-width:600px;"></canvas>
    </div>

    <!-- æŠ€å¸«ç®¡ç† -->
    <div v-if="activePage === 'staff'">
      <h2>æŠ€å¸«è³‡æ–™</h2>
      <el-table :data="staff" border>
        <el-table-column prop="name" label="å§“å"></el-table-column>
        <el-table-column prop="specialty" label="å°ˆé•·"></el-table-column>
        <el-table-column prop="jobs" label="å®Œæˆä»¶æ•¸"></el-table-column>
      </el-table>
    </div>
  </div>

  <script>
    const { createApp, ref, reactive, onMounted, computed } = Vue
    const app = createApp({
      setup() {
        const activePage = ref('jobs')
        const newJob = reactive({ customer: '', plate: '', item: '', price: 0 })
        const jobs = ref(JSON.parse(localStorage.getItem('jobs') || '[]'))
        const parts = ref([
          { name: 'æ©Ÿæ²¹', stock: 12, min: 5 },
          { name: 'ç…è»Šçš®', stock: 3, min: 5 },
          { name: 'ç«æ˜Ÿå¡', stock: 8, min: 3 }
        ])
        const customers = ref([
          { name: 'ç‹å°æ˜', phone: '0912-345-678', plate: 'ABC-1234', lastService: '2025/09/01' },
          { name: 'æå¤§è¯', phone: '0922-111-222', plate: 'DEF-5678', lastService: '2025/09/20' }
        ])
        const staff = ref([
          { name: 'é˜¿å®', specialty: 'å¼•æ“ç¶­ä¿®', jobs: 15 },
          { name: 'é˜¿å¼·', specialty: 'é›»ç³»æª¢ä¿®', jobs: 10 },
          { name: 'é˜¿è³¢', specialty: 'è¼ªèƒæ›´æ›', jobs: 8 }
        ])
        const searchCustomer = ref('')
        const filteredCustomers = computed(() => {
          return customers.value.filter(c =>
            c.name.includes(searchCustomer.value) || c.plate.includes(searchCustomer.value)
          )
        })

        const addJob = () => {
          if (!newJob.customer || !newJob.plate || !newJob.item) {
            ElementPlus.ElMessage.warning('è«‹å¡«å¯«å®Œæ•´è³‡æ–™')
            return
          }
          const id = jobs.value.length ? jobs.value[jobs.value.length - 1].id + 1 : 1
          jobs.value.push({ ...newJob, id, status: 'å¾…ç¶­ä¿®' })
          localStorage.setItem('jobs', JSON.stringify(jobs.value))
          newJob.customer = newJob.plate = newJob.item = ''
          newJob.price = 0
          ElementPlus.ElMessage.success('æ–°å¢æˆåŠŸ')
        }
        const deleteJob = (id) => {
          jobs.value = jobs.value.filter(j => j.id !== id)
          localStorage.setItem('jobs', JSON.stringify(jobs.value))
          ElementPlus.ElMessage.success('å·²åˆªé™¤')
        }
        const saveJobs = () => localStorage.setItem('jobs', JSON.stringify(jobs.value))
        const saveParts = () => ElementPlus.ElMessage.success('åº«å­˜å·²æ›´æ–°')

        onMounted(() => {
          const ctx = document.getElementById('chart')
          if (ctx) new Chart(ctx, {
            type: 'bar',
            data: {
              labels: ['7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ'],
              datasets: [{ label: 'æœˆç‡Ÿæ”¶', data: [18000, 24000, 30000, 32000] }]
            }
          })
        })

        return { activePage, newJob, jobs, addJob, deleteJob, saveJobs, parts, saveParts, customers, searchCustomer, filteredCustomers, staff }
      }
    })
    app.use(ElementPlus)
    app.mount('#app')
  </script>
</body>
</html>
